<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="Toolbars" script:language="StarBasic">

Sub createCorrectionToolbar
Dim toolbarName$
Dim tollbarDescription$

toolbarName = "correctionToolbar"
toolbarDescription = "Панель исправлений"
CreateWriterToolbar(toolbarName,toolbarDescription)
End Sub

Sub createCorrectionToolbarForEditors
Dim toolbarName$
Dim tollbarDescription$

toolbarName = "correctionToolbar"
toolbarDescription = "Панель исправлений"
CreateWriterEditorToolbar(toolbarName,toolbarDescription)
End Sub

Sub removeCorrectionToolbar
Dim sSupplier$    ' ModuleUIConfigurationManagerSupplier
Dim oSupplier     ' ModuleUIConfigurationManagerSupplier
Dim oModuleCfgMgr ' Module manager.
Dim sDocType$     ' Component type that will containt the toolbar.
sSupplier = "com.sun.star.ui.ModuleUIConfigurationManagerSupplier"
oSupplier = CreateUnoService(sSupplier)
sDocType = "com.sun.star.text.TextDocument"
oModuleCfgMgr = oSupplier.getUIConfigurationManager( sDocType )
sToolbarURL = "private:resource/toolbar/custom_toolbar_correctionToolbar"
If (oModuleCfgMgr.hasSettings(sToolbarURL)) Then
    oModuleCfgMgr.removeSettings(sToolbarURL)
    Exit Sub
End If
End Sub



Sub CreateWriterToolbar(toolbarName,toolbarDescription)
  Dim sToolbarURL$  ' URL of the custom toolbar.
  Dim sCmdID$       ' Command for a single toolbar button.
  Dim sCmdLable     ' Lable for a single toolbar button.
  Dim sDocType$     ' Component type that will containt the toolbar.
  Dim sSupplier$    ' ModuleUIConfigurationManagerSupplier
  Dim oSupplier     ' ModuleUIConfigurationManagerSupplier
  Dim sConfManager$ ' ModuleUIConfigurationManager
  Dim oConfManager  ' ModuleUIConfigurationManager
  Dim oModuleCfgMgr ' Module manager.
  Dim oTBSettings   ' Settings that comprise the toolbar.
  Dim oToolbarItem  ' Single toolbar button.
  Dim nCount%

  REM Name of the custom toolbar; must start with "custom_".
  sToolbarURL = "private:resource/toolbar/custom_toolbar_" &amp; toolbarName

  REM Retrieve the module configuration manager from the
  REM central module configuration manager supplier
  sSupplier = "com.sun.star.ui.ModuleUIConfigurationManagerSupplier"
  oSupplier = CreateUnoService(sSupplier)
  
  REM Specify the document type associated with this toolbar.
  sDocType = "com.sun.star.text.TextDocument"
  'sDocType = "com.sun.star.script.BasicIDE"

  REM Retrieve the module configuration manager with module identifier
  REM *** See com.sun.star.frame.ModuleManager for more information.
  oModuleCfgMgr = oSupplier.getUIConfigurationManager( sDocType )
  
  REM To remove a toolbar, you can use something like the following:
  'If (oModuleCfgMgr.hasSettings(sToolbarURL)) Then
  '  oModuleCfgMgr.removeSettings(sToolbarURL)
  '  Exit Sub
  'End If

  REM Create a settings container to define the structure of the
  REM custom toolbar.
  oTBSettings = oModuleCfgMgr.createSettings()
    
  REM *** Set a title for our new custom toolbar
  oTBSettings.UIName = toolbarDescription
    
  REM *** Create a button for our new custom toolbar
 ' sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeRemoveConsequentSpaces?language=Basic&amp;location=application"
 ' sCmdLable = "__"
 ' nCount = 0
 ' oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
 ' oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeRemoveBadCharacters?language=Basic&amp;location=application"
  sCmdLable = "!UTF"
  nCount = 0
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
 ' sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeRemoveSpacesBeforeStops?language=Basic&amp;location=application"
 ' sCmdLable = "_!"
 ' nCount = 2
 ' oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
 ' oTBSettings.insertByIndex( nCount, oToolbarItem )
  
 ' sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeNumericDashBetweenNumbers?language=Basic&amp;location=application"
 ' sCmdLable = "№-№"
 ' nCount = 3
 ' oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
 ' oTBSettings.insertByIndex( nCount, oToolbarItem )
  
 ' sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeReplaceLongDashWithSpacesBetweenWords?language=Basic&amp;location=application"
 ' sCmdLable = "а — а"
 ' nCount = 4
 ' oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
 ' oTBSettings.insertByIndex( nCount, oToolbarItem )
  
 ' sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeRemoveSpacesAfterOpenedQuoteOrBracket?language=Basic&amp;location=application"
 ' sCmdLable = "(_"
 ' nCount = 5
 ' oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
 ' oTBSettings.insertByIndex( nCount, oToolbarItem )
  
 ' sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeNonBreakingSpaceBetweenLastnameAndInitials?language=Basic&amp;location=application"
 ' sCmdLable = "Фам_И.О."
 ' nCount = 6
 ' oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
 ' oTBSettings.insertByIndex( nCount, oToolbarItem )
  
 ' sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeNonBreakingSpaceBetweenInitialsAndLastName?language=Basic&amp;location=application"
 ' sCmdLable = "И.О._Фам"
 ' nCount = 7
 ' oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
 ' oTBSettings.insertByIndex( nCount, oToolbarItem )
  
 ' sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeNonBreakingSpaceBetweenEtc?language=Basic&amp;location=application"
 ' sCmdLable = "и_т._д."
 ' nCount = 8
 ' oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
 ' oTBSettings.insertByIndex( nCount, oToolbarItem )
  
''  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeNonBreakingSpaceAfterPageOrVolume?language=Basic&amp;location=application"
''  sCmdLable = "c|том"
''  nCount = 9
''  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
''  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
'  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeNonBreakingSpaceBetweenVol?language=Basic&amp;location=application"
'  sCmdLable = "т._№"
'  nCount = 9
'  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
'  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
'  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeNonBreakingSpaceBetweenSeries?language=Basic&amp;location=application"
'  sCmdLable = "с._№"
'  nCount = 10
'  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
'  oTBSettings.insertByIndex( nCount, oToolbarItem )

'  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeNonBreakingSpaceBetweenPart?language=Basic&amp;location=application"
'  sCmdLable = "ч._№"
'  nCount = 11
'  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
'  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
'    sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeNonBreakingSpaceBetweenYear?language=Basic&amp;location=application"
'  sCmdLable = "г._№"
'  nCount = 12
'  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
'  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
 ' 'sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeNonBreakingSpaceBetweenPageNum?language=Basic&amp;location=application"
 ' 'sCmdLable = "с._№"
 ' 'nCount = 14
 ' 'oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
 ' 'oTBSettings.insertByIndex( nCount, oToolbarItem )
  
    sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeRemoveWhiteBackground?language=Basic&amp;location=application"
  sCmdLable = "Фон"
  nCount = 1
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.pageBreaks.executeShrinkPageContent?language=Basic&amp;location=application"
  sCmdLable = "Разрыв со сжатием"
  nCount = 2
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
    sCmdID   = "vnd.sun.star.script:Publishing.pageBreaks.executeSplitPages?language=Basic&amp;location=application"
  sCmdLable = "Разрыв"
  nCount = 3
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )

  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeMakeMeHappy?language=Basic&amp;location=application"
  sCmdLable = "Ошибки"
  nCount = 4
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.CleanManualFormat.executeClean?language=Basic&amp;location=application"
  sCmdLable = "Формат"
  nCount = 5
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeGothToArabicD?language=Basic&amp;location=application"
  sCmdLable = "Goth2ArabicD"
  nCount = 6
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeArabicDToGoth?language=Basic&amp;location=application"
  sCmdLable = "ArabicD2Goth"
  nCount = 7
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.unusedStyles.executeRemoveUnusedStyles?language=Basic&amp;location=application"
  sCmdLable = "Пустые стили"
  nCount = 8
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.CleanManualFormat.executeReplaceFonts?language=Basic&amp;location=application"
  sCmdLable = "ШрифтыВстили"
  nCount = 9
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.CleanManualFormat.NotesCleanStyle?language=Basic&amp;location=application"
  sCmdLable = "СтилиСносок"
  nCount = 10
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Indd.executeInsertINDDPageBreaks?language=Basic&amp;location=application"
  sCmdLable = "Indd"
  nCount = 11
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  REM To add a second item, increment nCount, create a new
  REM toolbar item, and insert it.
    
  REM *** Set the settings for our new custom toolbar. (replace/insert)
  If ( oModuleCfgMgr.hasSettings( sToolbarURL )) Then
    oModuleCfgMgr.replaceSettings( sToolbarURL, oTBSettings )
  Else
    oModuleCfgMgr.insertSettings( sToolbarURL, oTBSettings )
  End If
   
  oModuleCfgMgr.store()
   
End Sub

Rem A com.sun.star.ui.ItemDescriptor is an array of property
Rem values. This example does not set all supported  values, 
Rem such as "Style", which uses values 
Rem from com.sun.star.ui.ItemStyle. For menu items, the
Rem "ItemDescriptorContainer" is usually set as well.
Function CreateSimpleToolbarItem( sCommand$, sLabel ) as Variant
  Dim oItem(3) As New com.sun.star.beans.PropertyValue

  oItem(0).Name = "CommandURL"
  oItem(0).Value = sCommand
  oItem(1).Name = "Label"
  oItem(1).Value = sLabel
  
  REM Other supported types include SEPARATOR_LINE, 
  rem SEPARATOR_SPACE, and SEPARATOR_LINEBREAK.
  oItem(2).Name = "Type"
  oItem(2).Value = com.sun.star.ui.ItemType.DEFAULT
  
  oItem(3).Name = "Visible"
  oItem(3).Value = True

  CreateSimpleToolbarItem = oItem()
End Function

Sub CreateWriterEditorToolbar(toolbarName,toolbarDescription)
  Dim sToolbarURL$  ' URL of the custom toolbar.
  Dim sCmdID$       ' Command for a single toolbar button.
  Dim sCmdLable     ' Lable for a single toolbar button.
  Dim sDocType$     ' Component type that will containt the toolbar.
  Dim sSupplier$    ' ModuleUIConfigurationManagerSupplier
  Dim oSupplier     ' ModuleUIConfigurationManagerSupplier
  Dim sConfManager$ ' ModuleUIConfigurationManager
  Dim oConfManager  ' ModuleUIConfigurationManager
  Dim oModuleCfgMgr ' Module manager.
  Dim oTBSettings   ' Settings that comprise the toolbar.
  Dim oToolbarItem  ' Single toolbar button.
  Dim nCount%

  REM Name of the custom toolbar; must start with "custom_".
  sToolbarURL = "private:resource/toolbar/custom_toolbar_" &amp; toolbarName

  REM Retrieve the module configuration manager from the
  REM central module configuration manager supplier
  sSupplier = "com.sun.star.ui.ModuleUIConfigurationManagerSupplier"
  oSupplier = CreateUnoService(sSupplier)
  
  REM Specify the document type associated with this toolbar.
  sDocType = "com.sun.star.text.TextDocument"
  'sDocType = "com.sun.star.script.BasicIDE"

  REM Retrieve the module configuration manager with module identifier
  REM *** See com.sun.star.frame.ModuleManager for more information.
  oModuleCfgMgr = oSupplier.getUIConfigurationManager( sDocType )
  
  REM To remove a toolbar, you can use something like the following:
  'If (oModuleCfgMgr.hasSettings(sToolbarURL)) Then
  '  oModuleCfgMgr.removeSettings(sToolbarURL)
  '  Exit Sub
  'End If

  REM Create a settings container to define the structure of the
  REM custom toolbar.
  oTBSettings = oModuleCfgMgr.createSettings()
    
  REM *** Set a title for our new custom toolbar
  oTBSettings.UIName = toolbarDescription
    
  REM *** Create a button for our new custom toolbar
  
  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeRemoveBadCharacters?language=Basic&amp;location=application"
  sCmdLable = "Не юникод"
  nCount = 0
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeRemoveWhiteBackground?language=Basic&amp;location=application"
  sCmdLable = "Фон"
  nCount = 1
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )

  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeMakeMeHappy?language=Basic&amp;location=application"
  sCmdLable = "Ошибки"
  nCount = 2
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.CleanManualFormat.executeClean?language=Basic&amp;location=application"
  sCmdLable = "Формат"
  nCount = 3
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.unusedStyles.executeRemoveUnusedStyles?language=Basic&amp;location=application"
  sCmdLable = "Пустые стили"
  nCount = 4
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeGothToArabicD?language=Basic&amp;location=application"
  sCmdLable = "Goth2ArabicD"
  nCount = 5
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeArabicDToGoth?language=Basic&amp;location=application"
  sCmdLable = "ArabicD2Goth"
  nCount = 6
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  

  
  REM To add a second item, increment nCount, create a new
  REM toolbar item, and insert it.
    
  REM *** Set the settings for our new custom toolbar. (replace/insert)
  If ( oModuleCfgMgr.hasSettings( sToolbarURL )) Then
    oModuleCfgMgr.replaceSettings( sToolbarURL, oTBSettings )
  Else
    oModuleCfgMgr.insertSettings( sToolbarURL, oTBSettings )
  End If
   
  oModuleCfgMgr.store()
   
End Sub
</script:module>
