<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="Toolbars" script:language="StarBasic">

Sub createCorrectionToolbar
	Dim toolbarName$
	Dim tollbarDescription$
	toolbarName = "correctionFullToolbar"
	toolbarDescription = "Панель всех макросов"
	addWriterToolbar(toolbarName,toolbarDescription)
	'Copy macro
	copyCorrectionToGlobal (document, Basic)

End Sub

Sub createFontsToolbar
	Dim toolbarName$
	Dim tollbarDescription$
	toolbarName = "fontsToolbar"
	toolbarDescription = "Панель для работы со шрифтами"
	addFontsToolbar(toolbarName,toolbarDescription)
	'Copy macro
	copyCorrectionToGlobal (document, Basic)

End Sub

Sub createMakeUpToolbar
	Dim toolbarName$
	Dim tollbarDescription$
	toolbarName = "makeUpToolbar"
	toolbarDescription = "Инструменты верстки"
	addMakeUpToolbar(toolbarName,toolbarDescription)
	'Copy macro
	copyCorrectionToGlobal (document, Basic)

End Sub

Sub createCorrectionToolbarForEditors

	Dim toolbarName$
	Dim tollbarDescription$
	toolbarName = "correctionToolbar"
	toolbarDescription = "Панель исправлений"
	addWriterEditorToolbar(toolbarName,toolbarDescription)
	'Copy macro
	copyCorrectionToGlobal (document, Basic)
End Sub

Sub removeCorrectionToolbar
	Dim sSupplier$    ' ModuleUIConfigurationManagerSupplier
	Dim oSupplier     ' ModuleUIConfigurationManagerSupplier
	Dim oModuleCfgMgr ' Module manager.
	Dim sDocType$     ' Component type that will containt the toolbar.
	sSupplier = "com.sun.star.ui.ModuleUIConfigurationManagerSupplier"
	oSupplier = CreateUnoService(sSupplier)
	sDocType = "com.sun.star.text.TextDocument"
	oModuleCfgMgr = oSupplier.getUIConfigurationManager( sDocType )
	sToolbarURL = "private:resource/toolbar/custom_toolbar_correctionToolbar"
	If (oModuleCfgMgr.hasSettings(sToolbarURL)) Then
	    oModuleCfgMgr.removeSettings(sToolbarURL)
	    Exit Sub
	End If
End Sub



Sub addWriterToolbar(toolbarName,toolbarDescription)
  Dim sToolbarURL$  ' URL of the custom toolbar.
  Dim sCmdID$       ' Command for a single toolbar button.
  Dim sCmdLable     ' Lable for a single toolbar button.
  Dim sDocType$     ' Component type that will containt the toolbar.
  Dim sSupplier$    ' ModuleUIConfigurationManagerSupplier
  Dim oSupplier     ' ModuleUIConfigurationManagerSupplier
  Dim sConfManager$ ' ModuleUIConfigurationManager
  Dim oConfManager  ' ModuleUIConfigurationManager
  Dim oModuleCfgMgr ' Module manager.
  Dim oTBSettings   ' Settings that comprise the toolbar.
  Dim oToolbarItem  ' Single toolbar button.
  Dim nCount%

  REM Name of the custom toolbar; must start with "custom_".
  sToolbarURL = "private:resource/toolbar/custom_toolbar_" &amp; toolbarName

  REM Retrieve the module configuration manager from the
  REM central module configuration manager supplier
  sSupplier = "com.sun.star.ui.ModuleUIConfigurationManagerSupplier"
  oSupplier = CreateUnoService(sSupplier)
  
  REM Specify the document type associated with this toolbar.
  sDocType = "com.sun.star.text.TextDocument"
  'sDocType = "com.sun.star.script.BasicIDE"

  REM Retrieve the module configuration manager with module identifier
  REM *** See com.sun.star.frame.ModuleManager for more information.
  oModuleCfgMgr = oSupplier.getUIConfigurationManager( sDocType )
  
  REM To remove a toolbar, you can use something like the following:
  'If (oModuleCfgMgr.hasSettings(sToolbarURL)) Then
  '  oModuleCfgMgr.removeSettings(sToolbarURL)
  '  Exit Sub
  'End If

  REM Create a settings container to define the structure of the
  REM custom toolbar.
  oTBSettings = oModuleCfgMgr.createSettings()
    
  REM *** Set a title for our new custom toolbar
  oTBSettings.UIName = toolbarDescription
    

  sCmdID   = "vnd.sun.star.script:Publishing.journals.makeUpIssue?language=Basic&amp;location=application"
  sCmdLable = "СВ"
  nCount = 0
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.journals.setPageNumbers?language=Basic&amp;location=application"
  sCmdLable = "№стр.статей"
  nCount = 1
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  
  sCmdID   = "vnd.sun.star.script:Publishing.pageBreaks.shrinkPageContent?language=Basic&amp;location=application"
  sCmdLable = "Разрыв со сжатием"
  nCount = 2
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
    sCmdID   = "vnd.sun.star.script:Publishing.pageBreaks.splitPages?language=Basic&amp;location=application"
  sCmdLable = "Разрыв"
  nCount = 3
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )

  sCmdID   = "vnd.sun.star.script:Publishing.CleanManualFormat.executeReplaceFonts?language=Basic&amp;location=application"
  sCmdLable = "ШрифтыВстили"
  nCount = 4
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.CleanManualFormat.NotesCleanStyle?language=Basic&amp;location=application"
  sCmdLable = "СтилиСносок"
  nCount = 5
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Indd.executeInsertINDDPageBreaks?language=Basic&amp;location=application"
  sCmdLable = "Indd"
  nCount = 6
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Indd.CreateBidirectionalLink?language=Basic&amp;location=application"
  sCmdLable = "CreateBidirectionalLink"
  nCount = 7
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )

  
  sCmdID   = "vnd.sun.star.script:Publishing.Documents.setDimensions?language=Basic&amp;location=application"
  sCmdLable = "⍁"
  nCount = 8
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  
  sCmdID   = "vnd.sun.star.script:Publishing.journals.setManualOutlineLevel?language=Basic&amp;location=application"
  sCmdLable = "Огл."
  nCount = 9
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  
  sCmdID   = "vnd.sun.star.script:Publishing.Documents.setBookUniqPageStyles?language=Basic&amp;location=application"
  sCmdLable = "Стр.книг"
  nCount = 10
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Bookmarks.convertBookmarksToFootnotes?language=Basic&amp;location=application"
  sCmdLable = "html2FN"
  nCount = 11
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  REM *** Set the settings for our new custom toolbar. (replace/insert)
  If ( oModuleCfgMgr.hasSettings( sToolbarURL )) Then
    oModuleCfgMgr.replaceSettings( sToolbarURL, oTBSettings )
  Else
    oModuleCfgMgr.insertSettings( sToolbarURL, oTBSettings )
  End If
   
  oModuleCfgMgr.store()
   
End Sub

Rem A com.sun.star.ui.ItemDescriptor is an array of property
Rem values. This example does not set all supported  values, 
Rem such as "Style", which uses values 
Rem from com.sun.star.ui.ItemStyle. For menu items, the
Rem "ItemDescriptorContainer" is usually set as well.
Function CreateSimpleToolbarItem( sCommand$, sLabel ) as Variant
  Dim oItem(3) As New com.sun.star.beans.PropertyValue

  oItem(0).Name = "CommandURL"
  oItem(0).Value = sCommand
  oItem(1).Name = "Label"
  oItem(1).Value = sLabel
  
  REM Other supported types include SEPARATOR_LINE, 
  rem SEPARATOR_SPACE, and SEPARATOR_LINEBREAK.
  oItem(2).Name = "Type"
  oItem(2).Value = com.sun.star.ui.ItemType.DEFAULT
  
  oItem(3).Name = "Visible"
  oItem(3).Value = True

  CreateSimpleToolbarItem = oItem()
End Function

Sub addWriterEditorToolbar(toolbarName,toolbarDescription)
  Dim sToolbarURL$  ' URL of the custom toolbar.
  Dim sCmdID$       ' Command for a single toolbar button.
  Dim sCmdLable     ' Lable for a single toolbar button.
  Dim sDocType$     ' Component type that will containt the toolbar.
  Dim sSupplier$    ' ModuleUIConfigurationManagerSupplier
  Dim oSupplier     ' ModuleUIConfigurationManagerSupplier
  Dim sConfManager$ ' ModuleUIConfigurationManager
  Dim oConfManager  ' ModuleUIConfigurationManager
  Dim oModuleCfgMgr ' Module manager.
  Dim oTBSettings   ' Settings that comprise the toolbar.
  Dim oToolbarItem  ' Single toolbar button.
  Dim nCount%

  REM Name of the custom toolbar; must start with "custom_".
  sToolbarURL = "private:resource/toolbar/custom_toolbar_" &amp; toolbarName
  REM central module configuration manager supplier
  sSupplier = "com.sun.star.ui.ModuleUIConfigurationManagerSupplier"
  oSupplier = CreateUnoService(sSupplier)
  
  REM Specify the document type associated with this toolbar.
  sDocType = "com.sun.star.text.TextDocument"
  oModuleCfgMgr = oSupplier.getUIConfigurationManager( sDocType )
  oTBSettings = oModuleCfgMgr.createSettings()
  oTBSettings.UIName = toolbarDescription
  
  sCmdID   = "vnd.sun.star.script:Publishing.Correction.removeBadCharacters?language=Basic&amp;location=application"
  sCmdLable = "Не юникод"
  nCount = 0
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.Correction.executeRemoveWhiteBackground?language=Basic&amp;location=application"
  sCmdLable = "Фон"
  nCount = 1
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.CleanManualFormat.executeClean?language=Basic&amp;location=application"
  sCmdLable = "Формат"
  nCount = 2
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.unusedStyles.executeRemoveUnusedStyles?language=Basic&amp;location=application"
  sCmdLable = "Пустые стили"
  nCount = 3
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
    
  sCmdID   = "vnd.sun.star.script:Publishing.Correction.fixFrequentMistakes?language=Basic&amp;location=application"
  sCmdLable = "Ошибки"
  nCount = 4
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  REM *** Set the settings for our new custom toolbar. (replace/insert)
  If ( oModuleCfgMgr.hasSettings( sToolbarURL )) Then
    oModuleCfgMgr.replaceSettings( sToolbarURL, oTBSettings )
  Else
    oModuleCfgMgr.insertSettings( sToolbarURL, oTBSettings )
  End If
   
  oModuleCfgMgr.store()
   
End Sub

Sub addFontsToolbar(toolbarName,toolbarDescription)
  Dim sToolbarURL$  ' URL of the custom toolbar.
  Dim sCmdID$       ' Command for a single toolbar button.
  Dim sCmdLable     ' Lable for a single toolbar button.
  Dim sDocType$     ' Component type that will containt the toolbar.
  Dim sSupplier$    ' ModuleUIConfigurationManagerSupplier
  Dim oSupplier     ' ModuleUIConfigurationManagerSupplier
  Dim sConfManager$ ' ModuleUIConfigurationManager
  Dim oConfManager  ' ModuleUIConfigurationManager
  Dim oModuleCfgMgr ' Module manager.
  Dim oTBSettings   ' Settings that comprise the toolbar.
  Dim oToolbarItem  ' Single toolbar button.
  Dim nCount%

  REM Name of the custom toolbar; must start with "custom_".
  sToolbarURL = "private:resource/toolbar/custom_toolbar_" &amp; toolbarName
  REM central module configuration manager supplier
  sSupplier = "com.sun.star.ui.ModuleUIConfigurationManagerSupplier"
  oSupplier = CreateUnoService(sSupplier)
  
  REM Specify the document type associated with this toolbar.
  sDocType = "com.sun.star.text.TextDocument"
  oModuleCfgMgr = oSupplier.getUIConfigurationManager( sDocType )
  oTBSettings = oModuleCfgMgr.createSettings()
  oTBSettings.UIName = toolbarDescription
  
  sCmdID   = "vnd.sun.star.script:Publishing.replaceFonts.TNR2IPH?language=Basic&amp;location=application"
  sCmdLable = "TNR2IPH"
  nCount = 0
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )

  sCmdID   = "vnd.sun.star.script:Publishing.replaceFonts.Univ2IPH?language=Basic&amp;location=application"
  sCmdLable = "Univ2IPH"
  nCount = 1
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.replaceFonts.goth2IPH?language=Basic&amp;location=application"
  sCmdLable = "Goth2IPH"
  nCount = 2
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.replaceFonts.IPH2Goth?language=Basic&amp;location=application"
  sCmdLable = "IPH2Goth"
  nCount = 3
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
    
  sCmdID   = "vnd.sun.star.script:Publishing.replaceFonts.TimesAr2IPH?language=Basic&amp;location=application"
  sCmdLable = "TimesAr2IPH"
  nCount = 4
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.replaceFonts.badGoth2IPH?language=Basic&amp;location=application"
  sCmdLable = "badGoth2IPH"
  nCount = 5
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  REM *** Set the settings for our new custom toolbar. (replace/insert)
  If ( oModuleCfgMgr.hasSettings( sToolbarURL )) Then
    oModuleCfgMgr.replaceSettings( sToolbarURL, oTBSettings )
  Else
    oModuleCfgMgr.insertSettings( sToolbarURL, oTBSettings )
  End If
   
  oModuleCfgMgr.store()
   
End Sub

Sub addMakeUpToolbar(toolbarName,toolbarDescription)
  Dim sToolbarURL$  ' URL of the custom toolbar.
  Dim sCmdID$       ' Command for a single toolbar button.
  Dim sCmdLable     ' Lable for a single toolbar button.
  Dim sDocType$     ' Component type that will containt the toolbar.
  Dim sSupplier$    ' ModuleUIConfigurationManagerSupplier
  Dim oSupplier     ' ModuleUIConfigurationManagerSupplier
  Dim sConfManager$ ' ModuleUIConfigurationManager
  Dim oConfManager  ' ModuleUIConfigurationManager
  Dim oModuleCfgMgr ' Module manager.
  Dim oTBSettings   ' Settings that comprise the toolbar.
  Dim oToolbarItem  ' Single toolbar button.
  Dim nCount%

  REM Name of the custom toolbar; must start with "custom_".
  sToolbarURL = "private:resource/toolbar/custom_toolbar_" &amp; toolbarName
  REM central module configuration manager supplier
  sSupplier = "com.sun.star.ui.ModuleUIConfigurationManagerSupplier"
  oSupplier = CreateUnoService(sSupplier)
  
  REM Specify the document type associated with this toolbar.
  sDocType = "com.sun.star.text.TextDocument"
  oModuleCfgMgr = oSupplier.getUIConfigurationManager( sDocType )
  oTBSettings = oModuleCfgMgr.createSettings()
  oTBSettings.UIName = toolbarDescription
  
  sCmdID   = "vnd.sun.star.script:Publishing.makeUpToolbar.incrementCharWidth?language=Basic&amp;location=application"
  sCmdLable = "%+"
  nCount = 0
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )

  sCmdID   = "vnd.sun.star.script:Publishing.makeUpToolbar.decrementCharWidth?language=Basic&amp;location=application"
  sCmdLable = "%‒"
  nCount = 1
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.makeUpToolbar.incrementKern?language=Basic&amp;location=application"
  sCmdLable = "K+"
  nCount = 2
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  sCmdID   = "vnd.sun.star.script:Publishing.makeUpToolbar.decrementKern?language=Basic&amp;location=application"
  sCmdLable = "K‒"
  nCount = 3
  oToolbarItem = CreateSimpleToolbarItem( sCmdID, sCmdLable )
  oTBSettings.insertByIndex( nCount, oToolbarItem )
  
  REM *** Set the settings for our new custom toolbar. (replace/insert)
  If ( oModuleCfgMgr.hasSettings( sToolbarURL )) Then
    oModuleCfgMgr.replaceSettings( sToolbarURL, oTBSettings )
  Else
    oModuleCfgMgr.insertSettings( sToolbarURL, oTBSettings )
  End If
   
  oModuleCfgMgr.store()
   
End Sub
</script:module>
