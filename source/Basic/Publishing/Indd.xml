<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="Indd" script:language="StarBasic">sub executeInsertINDDPageBreaks
document   = ThisComponent.CurrentController.Frame
dispatcher = createUnoService("com.sun.star.frame.DispatchHelper")
oVC = thisComponent.getCurrentController.getViewCursor
oVC.jumpToFirstPage
Dim args(0) as new com.sun.star.beans.PropertyValue

rem Turn off tracking changes to prevent infinite
args(0).Name = "TrackChanges"
args(0).Value = false
dispatcher.executeDispatch(document, ".uno:TrackChanges", "", 0, args())

Dim oSearch
Dim oTextCursor 
Dim lineIndent
oSearch = ThisComponent.createSearchDescriptor()
oSearch.SearchString = "---XYXYX---"
oSearch.SearchRegularExpression=True
oSearch.searchAll=True
oFound = ThisComponent.findFirst(oSearch)
Do While Not IsNull(oFound)
  oTextCursor = oFound.Text.createTextCursor()
  oTextCursor.gotoRange(oFound,false)

rem  oTextCursor.goRight(1,false)
rem  lineIndent = oTextCursor.ParaFirstLineIndent
rem  oTextCursor.goLeft(1,false)
  
  oTextCursor.gotoStartOfParagraph(false)
  oTextCursor.gotoEndOfParagraph(true)
  oTextCursor.goRight(1,true)
  
  oTextCursor.String = ""
  oTextCursor.BreakType = com.sun.star.style.BreakType.PAGE_BEFORE
rem  oTextCursor.ParaFirstLineIndent = lineIndent
'check first character is lowercase.
  oTextCursor.goRight(1,true)
  Dim charNum
  Dim character 
  character = oTextCursor.string
  If (character = "") Then
	character="0"
  End If
  charNum = ASC(character)
'check if first character is in lowercase
  If ((charNum &gt; 1071 AND charNum &lt; 1104) Or (charNum &gt; 60 AND charNum &lt; 123)) Then
  	oTextCursor.ParaFirstLineIndent = 0
  End If
  
  
  oFound = ThisComponent.findNext(oFound.End, oSearch)
Loop

end Sub
</script:module>
